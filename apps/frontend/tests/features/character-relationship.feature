Feature: キャラクター関係管理
  TRPGシナリオ作成アプリのユーザーとして
  キャラクター間の関係性を作成・編集・削除したい
  シナリオ内のキャラクター関係を管理できるようにするため

  Scenario: キャラクター関係の基本操作
    Given アプリケーションを開いている

    # キャラクター管理画面へ移動
    When ナビゲーションで "キャラクター管理" をクリックする
    Then キャラクター一覧が表示される

    # テスト用キャラクターを作成（勇者）
    When "新規作成" ボタンをクリックする
    And キャラクター名に "勇者" と入力する
    And キャラクター説明に "世界を救う勇者" と入力する
    And モーダルの "作成" ボタンをクリックする
    Then キャラクター一覧に "勇者" が表示される

    # テスト用キャラクターを作成（姫）
    When "新規作成" ボタンをクリックする
    And キャラクター名に "姫" と入力する
    And キャラクター説明に "国の姫" と入力する
    And モーダルの "作成" ボタンをクリックする
    Then キャラクター一覧に "姫" が表示される

    # 関係性を作成
    When "関係性を追加" ボタンをクリックする
    And 関係元キャラクターで "勇者" を選択する
    And 関係先キャラクターで "姫" を選択する
    And 関係名に "守る" と入力する
    And 作成フォームの "追加" ボタンをクリックする
    Then 関係性 "勇者" から "姫" への "守る" が表示される

    # 関係性を編集
    When 関係性 "勇者" から "姫" への "守る" の編集ボタンをクリックする
    And 関係名を "愛している" に変更する
    And 編集フォームの "更新" ボタンをクリックする
    Then 関係性 "勇者" から "姫" への "愛している" が表示される

    # 逆方向の関係性を作成（双方向テスト）
    When "関係性を追加" ボタンをクリックする
    And 関係元キャラクターで "姫" を選択する
    And 関係先キャラクターで "勇者" を選択する
    And 関係名に "慕っている" と入力する
    And 作成フォームの "追加" ボタンをクリックする
    Then 関係性 "姫" から "勇者" への "慕っている" が表示される
    And 関係性 "勇者" から "姫" への "愛している" が表示される

#    # 勇者→姫の関係性を削除
#    When 関係性 "勇者" から "姫" への "愛している" の削除ボタンをクリックする
#    And 削除確認モーダルで "削除" ボタンをクリックする
#    Then 関係性 "勇者" から "姫" への "愛している" が表示されない
#    And 関係性 "姫" から "勇者" への "慕っている" が表示される

#    # 姫→勇者の関係性を削除
#    When 関係性 "姫" から "勇者" への "慕っている" の削除ボタンをクリックする
#    And 削除確認モーダルで "削除" ボタンをクリックする
#    Then 関係性 "姫" から "勇者" への "慕っている" が表示されない
