@ignore
Feature: キャラクター画像管理
  TRPGシナリオ作成アプリのユーザーとして
  キャラクターに画像を追加・管理したい
  キャラクターの視覚的な表現を豊かにするため

  Background:
    Given アプリケーションを開いている
    And ナビゲーションで "キャラクター管理" をクリックする
    And "新規作成" ボタンをクリックする
    And キャラクター名に "勇者" と入力する
    And キャラクター説明に "世界を救う勇者" と入力する
    And モーダルの "作成" ボタンをクリックする
    And キャラクター一覧で "勇者" をクリックする

  Scenario: キャラクターに最初の画像を追加する
    When "画像を追加" ボタンをクリックする
    Then 画像アップロードモーダルが表示される
    When テスト画像をアップロードする
    And モーダルの "追加" ボタンをクリックする
    Then 画像ギャラリーに画像が1枚表示される
    And その画像がメイン画像として表示される
  @ignore
  Scenario: キャラクターに複数の画像を追加する
    # 1枚目の画像を追加
    When "画像を追加" ボタンをクリックする
    And テスト画像 "image1" をアップロードする
    And モーダルの "追加" ボタンをクリックする
    Then 画像ギャラリーに画像が1枚表示される

    # 2枚目の画像を追加
    When "画像を追加" ボタンをクリックする
    And テスト画像 "image2" をアップロードする
    And モーダルの "追加" ボタンをクリックする
    Then 画像ギャラリーに画像が2枚表示される

    # 3枚目の画像を追加
    When "画像を追加" ボタンをクリックする
    And テスト画像 "image3" をアップロードする
    And モーダルの "追加" ボタンをクリックする
    Then 画像ギャラリーに画像が3枚表示される
  @ignore
  Scenario: メイン画像を変更する
    # 複数の画像を追加
    When "画像を追加" ボタンをクリックする
    And テスト画像 "image1" をアップロードする
    And モーダルの "追加" ボタンをクリックする
    And "画像を追加" ボタンをクリックする
    And テスト画像 "image2" をアップロードする
    And モーダルの "追加" ボタンをクリックする
    Then 画像 "image1" がメイン画像として表示される

    # メイン画像を変更
    When 画像 "image2" にマウスをホバーする
    And "メインに設定" ボタンをクリックする
    Then 画像 "image2" がメイン画像として表示される
    And 画像 "image1" は通常の画像として表示される
  @ignore
  Scenario: 追加時にメイン画像を指定する
    # 1枚目の画像を追加
    When "画像を追加" ボタンをクリックする
    And テスト画像 "image1" をアップロードする
    And モーダルの "追加" ボタンをクリックする

    # 2枚目の画像をメイン画像として追加
    When "画像を追加" ボタンをクリックする
    And テスト画像 "image2" をアップロードする
    And "この画像をメイン画像に設定" チェックボックスをチェックする
    And モーダルの "追加" ボタンをクリックする
    Then 画像 "image2" がメイン画像として表示される
    And 画像 "image1" は通常の画像として表示される
  @ignore
  Scenario: 画像を削除する
    # 複数の画像を追加
    When "画像を追加" ボタンをクリックする
    And テスト画像 "image1" をアップロードする
    And モーダルの "追加" ボタンをクリックする
    And "画像を追加" ボタンをクリックする
    And テスト画像 "image2" をアップロードする
    And モーダルの "追加" ボタンをクリックする
    Then 画像ギャラリーに画像が2枚表示される

    # 画像を削除
    When 画像 "image2" にマウスをホバーする
    And "削除" ボタンをクリックする
    And 確認ダイアログで "OK" をクリックする
    Then 画像ギャラリーに画像が1枚表示される
    And 画像 "image2" は表示されない
  @ignore
  Scenario: メイン画像を削除すると次の画像がメインになる
    # 複数の画像を追加
    When "画像を追加" ボタンをクリックする
    And テスト画像 "image1" をアップロードする
    And モーダルの "追加" ボタンをクリックする
    And "画像を追加" ボタンをクリックする
    And テスト画像 "image2" をアップロードする
    And モーダルの "追加" ボタンをクリックする
    Then 画像 "image1" がメイン画像として表示される

    # メイン画像を削除
    When 画像 "image1" にマウスをホバーする
    And "削除" ボタンをクリックする
    And 確認ダイアログで "OK" をクリックする
    Then 画像ギャラリーに画像が1枚表示される
    And 画像 "image2" がメイン画像として表示される
  @ignore
  Scenario: 画像がない状態を確認する
    Then "画像が登録されていません" というメッセージが表示される
    And "最初の画像を追加" ボタンが表示される
  @ignore
  Scenario: アップロードをキャンセルする
    When "画像を追加" ボタンをクリックする
    Then 画像アップロードモーダルが表示される
    When テスト画像をアップロードする
    And モーダルの "キャンセル" ボタンをクリックする
    Then 画像アップロードモーダルが閉じる
    And 画像ギャラリーに画像が追加されていない
